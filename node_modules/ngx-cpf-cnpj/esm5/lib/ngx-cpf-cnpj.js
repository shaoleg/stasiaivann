var NgxCpfCnpj = /** @class */ (function () {
    function NgxCpfCnpj() {
    }
    NgxCpfCnpj.convertToCpfCnpj = function (num) {
        if (num && num.length > 3 && num.length <= 14) {
            var replaceByLength = {
                4: { searchValue: /(\d+)(\d{3})/, newValue: "$1.$2" },
                5: { searchValue: /(\d+)(\d{3})/, newValue: "$1.$2" },
                6: { searchValue: /(\d+)(\d{3})/, newValue: "$1.$2" },
                7: { searchValue: /(\d+)(\d{3})(\d{3})/, newValue: "$1.$2.$3" },
                8: { searchValue: /(\d+)(\d{3})(\d{3})/, newValue: "$1.$2.$3" },
                9: { searchValue: /(\d+)(\d{3})(\d{3})/, newValue: "$1.$2.$3" },
                10: {
                    searchValue: /(\d+)(\d{3})(\d{3})(\d{1})/,
                    newValue: "$1.$2.$3-$4"
                },
                11: {
                    searchValue: /(\d+)(\d{3})(\d{3})(\d{2})/,
                    newValue: "$1.$2.$3-$4"
                },
                12: {
                    searchValue: /(\d+)(\d{3})(\d{3})(\d{4})/,
                    newValue: "$1.$2.$3-$4"
                },
                13: {
                    searchValue: /(\d+)(\d{3})(\d{3})(\d{4})(\d{2})/,
                    newValue: "$1.$2.$3/$4-$5"
                },
                14: {
                    searchValue: /(\d+)(\d{3})(\d{3})(\d{4})(\d{2})/,
                    newValue: "$1.$2.$3/$4-$5"
                }
            };
            num = num.toString();
            num = NgxCpfCnpj.getDigitos(num);
            var replaceObject = replaceByLength[num.length];
            num = num.replace(replaceObject.searchValue, replaceObject.newValue);
        }
        return num;
    };
    NgxCpfCnpj.getDigitos = function (value) {
        var regex = new RegExp("\\D", "g");
        return value.replace(regex, "");
    };
    NgxCpfCnpj.cpfIsValid = function (value) {
        // Só faz a validação se o texto não for vazio.
        // Se for vazio, validar campo requerido não é a responsabilidade desta validação
        if (value.length > 0) {
            var IsValid = false;
            var cpf = NgxCpfCnpj.getDigitos(value); // Obtém o texto digitado no campo, remove tudo menos os digitos
            if (cpf.length === 11) {
                // Se digitou o CPF por completo
                // Verificação dos CPF's que não respeitam a regra de validação mas não são válidos
                var cpf_invalidos = [
                    "00000000000",
                    "11111111111",
                    "22222222222",
                    "33333333333",
                    "44444444444",
                    "55555555555",
                    "66666666666",
                    "77777777777",
                    "88888888888",
                    "99999999999"
                ];
                for (var i = 0; i < 10; i++) {
                    if (cpf === cpf_invalidos[i]) {
                        return IsValid;
                    }
                }
                // Calculando o Primeiro Dígito Verificador
                var soma = 0; // Soma para o CPF "ABC.DEF.GHI-XZ": (A*10)+(B*9)+...+(H*3)+(I*2)
                for (var i = 0; i < 9; i++) {
                    soma = soma + parseInt(cpf.charAt(i), 10) * (10 - i);
                }
                var dv = 0; // Primeiro dígito verificador (será zero se o resto da divisão de soma por 11 for < 2)
                if (soma % 11 > 1) {
                    dv = 11 - (soma % 11);
                }
                if (parseInt(cpf.charAt(9), 10) !== dv) {
                    return IsValid;
                }
                // Calculando o Segundo Dígito Verificador
                soma = 0; // Soma para o CPF "ABC.DEF.GHI-XZ": (A*11)+(B*10)+...+(H*4)+(I*3)+(X*2)
                for (var i = 0; i < 10; i++) {
                    soma = soma + parseInt(cpf.charAt(i), 10) * (11 - i);
                }
                dv = 0; // Segundo dígito verificador (será zero se o resto da divisão de soma por 11 for < 2)
                if (soma % 11 > 1) {
                    dv = 11 - (soma % 11);
                }
                if (parseInt(cpf.charAt(10), 10) !== dv) {
                    return IsValid;
                }
                IsValid = true;
            }
            return IsValid;
        }
        return true;
    };
    NgxCpfCnpj.cnpjIsValid = function (value) {
        // Só faz a validação se o texto não for vazio.
        // Se for vazio, validar campo requerido não é a responsabilidade desta validação
        if (value.length > 0) {
            var IsValid = false;
            var cnpj = NgxCpfCnpj.getDigitos(value); // Obtém o texto digitado no campo, remove tudo menos os digitos
            if (cnpj.length === 14) {
                // Se digitou o CNPJ por completo
                // Verificação do CNPJ que não respeita a regra de validação mas não são válidos
                if (cnpj === "00000000000000") {
                    return IsValid;
                }
                // Calculando o Primeiro Dígito Verificador
                var soma = 0; // Soma para o CNPJ "AB.CDE.FGH/IJKL-XZ": (A*5)+(B*4)+(C*3)+(D*2)+(E*9)+(F*8)+...+(K*3)+(L*2)
                var mult = 5; // multiplicador
                for (var i = 0; i < 12; i++) {
                    soma = soma + parseInt(cnpj.charAt(i), 10) * mult;
                    mult--; // decrementa o multiplicador
                    if (mult === 1) {
                        mult = 9;
                    } // volta o multiplicador para o valor 9 (para decrementar até o valor 2)
                }
                var dv = 0; // Primeiro dígito verificador (será zero se o resto da divisão de soma por 11 for < 2)
                if (soma % 11 > 1) {
                    dv = 11 - (soma % 11);
                }
                if (parseInt(cnpj.charAt(12), 10) !== dv) {
                    return IsValid;
                }
                // Calculando o Segundo Dígito Verificador
                soma = 0; // Soma para o CNPJ "AB.CDE.FGH/IJKL-XZ": (A*6)+(B*5)+(C*4)+(D*3)+(E*2)+(F*9)+...+(K*4)+(L*3)+(X*2)
                mult = 6; // multiplicador
                for (var i = 0; i < 13; i++) {
                    soma = soma + parseInt(cnpj.charAt(i), 10) * mult;
                    mult--; // decrementa o multiplicador
                    if (mult === 1) {
                        mult = 9;
                    } // volta o multiplicador para o valor 9 (para decrementar até o valor 2)
                }
                dv = 0; // Segundo dígito verificador (será zero se o resto da divisão de soma por 11 for < 2)
                if (soma % 11 > 1) {
                    dv = 11 - (soma % 11);
                }
                if (parseInt(cnpj.charAt(13), 10) !== dv) {
                    return IsValid;
                }
                IsValid = true;
            }
            return IsValid;
        }
        return true;
    };
    return NgxCpfCnpj;
}());
export { NgxCpfCnpj };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWNwZi1jbnBqLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LWNwZi1jbnBqLyIsInNvdXJjZXMiOlsibGliL25neC1jcGYtY25wai50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNFO0lBQWUsQ0FBQztJQUVGLDJCQUFnQixHQUE5QixVQUErQixHQUFHO1FBQ2hDLElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxNQUFNLElBQUksRUFBRSxFQUFFO1lBQzdDLElBQU0sZUFBZSxHQUFHO2dCQUN0QixDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUsY0FBYyxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUU7Z0JBQ3JELENBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRSxjQUFjLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRTtnQkFDckQsQ0FBQyxFQUFFLEVBQUUsV0FBVyxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFO2dCQUNyRCxDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUscUJBQXFCLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRTtnQkFDL0QsQ0FBQyxFQUFFLEVBQUUsV0FBVyxFQUFFLHFCQUFxQixFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUU7Z0JBQy9ELENBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRSxxQkFBcUIsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFO2dCQUMvRCxFQUFFLEVBQUU7b0JBQ0YsV0FBVyxFQUFFLDRCQUE0QjtvQkFDekMsUUFBUSxFQUFFLGFBQWE7aUJBQ3hCO2dCQUNELEVBQUUsRUFBRTtvQkFDRixXQUFXLEVBQUUsNEJBQTRCO29CQUN6QyxRQUFRLEVBQUUsYUFBYTtpQkFDeEI7Z0JBQ0QsRUFBRSxFQUFFO29CQUNGLFdBQVcsRUFBRSw0QkFBNEI7b0JBQ3pDLFFBQVEsRUFBRSxhQUFhO2lCQUN4QjtnQkFDRCxFQUFFLEVBQUU7b0JBQ0YsV0FBVyxFQUFFLG1DQUFt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QUFHLEVBQUUsR0FBRyxDQUFDLEVBQUU7b0JBQ2pCLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7aUJBQ3ZCO2dCQUNELElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO29CQUN4QyxPQUFPLE9BQU8sQ0FBQztpQkFDaEI7Z0JBRUQsT0FBTyxHQUFHLElBQUksQ0FBQzthQUNoQjtZQUNELE9BQU8sT0FBTyxDQUFDO1NBQ2hCO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBcktELElBcUtDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIE5neENwZkNucGoge1xyXG4gIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgcHVibGljIHN0YXRpYyBjb252ZXJ0VG9DcGZDbnBqKG51bSkge1xyXG4gICAgaWYgKG51bSAmJiBudW0ubGVuZ3RoID4gMyAmJiBudW0ubGVuZ3RoIDw9IDE0KSB7XHJcbiAgICAgIGNvbnN0IHJlcGxhY2VCeUxlbmd0aCA9IHtcclxuICAgICAgICA0OiB7IHNlYXJjaFZhbHVlOiAvKFxcZCspKFxcZHszfSkvLCBuZXdWYWx1ZTogXCIkMS4kMlwiIH0sXHJcbiAgICAgICAgNTogeyBzZWFyY2hWYWx1ZTogLyhcXGQrKShcXGR7M30pLywgbmV3VmFsdWU6IFwiJDEuJDJcIiB9LFxyXG4gICAgICAgIDY6IHsgc2VhcmNoVmFsdWU6IC8oXFxkKykoXFxkezN9KS8sIG5ld1ZhbHVlOiBcIiQxLiQyXCIgfSxcclxuICAgICAgICA3OiB7IHNlYXJjaFZhbHVlOiAvKFxcZCspKFxcZHszfSkoXFxkezN9KS8sIG5ld1ZhbHVlOiBcIiQxLiQyLiQzXCIgfSxcclxuICAgICAgICA4OiB7IHNlYXJjaFZhbHVlOiAvKFxcZCspKFxcZHszfSkoXFxkezN9KS8sIG5ld1ZhbHVlOiBcIiQxLiQyLiQzXCIgfSxcclxuICAgICAgICA5OiB7IHNlYXJjaFZhbHVlOiAvKFxcZCspKFxcZHszfSkoXFxkezN9KS8sIG5ld1ZhbHVlOiBcIiQxLiQyLiQzXCIgfSxcclxuICAgICAgICAxMDoge1xyXG4gICAgICAgICAgc2VhcmNoVmFsdWU6IC8oXFxkKykoXFxkezN9KShcXGR7M30pKFxcZHsxfSkvLFxyXG4gICAgICAgICAgbmV3VmFsdWU6IFwiJDEuJDIuJDMtJDRcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgMTE6IHtcclxuICAgICAgICAgIHNlYXJjaFZhbHVlOiAvKFxcZCspKFxcZHszfSkoXFxkezN9KShcXGR7Mn0pLyxcclxuICAgICAgICAgIG5ld1ZhbHVlOiBcIiQxLiQyLiQzLSQ0XCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIDEyOiB7XHJcbiAgICAgICAgICBzZWFyY2hWYWx1ZTogLyhcXGQrKShcXGR7M30pKFxcZHszfSkoXFxkezR9KS8sXHJcbiAgICAgICAgICBuZXdWYWx1ZTogXCIkMS4kMi4kMy0kNFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICAxMzoge1xyXG4gICAgICAgICAgc2VhcmNoVmFsdWU6IC8oXFxkKykoXFxkezN9KShcXGR7M30pKFxcZHs0fSkoXFxkezJ9KS8sXHJcbiAgICAgICAgICBuZXdWYWx1ZTogXCIkMS4kMi4kMy8kNC0kNVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICAxNDoge1xyXG4gICAgICAgICAgc2VhcmNoVmFsdWU6IC8oXFxkKykoXFxkezN9KShcXGR7M30pKFxcZHs0fSkoXFxkezJ9KS8sXHJcbiAgICAgICAgICBuZXdWYWx1ZTogXCIkMS4kMi4kMy8kNC0kNVwiXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbnVtID0gbnVtLnRvU3RyaW5nKCk7XHJcbiAgICAgIG51bSA9IE5neENwZkNucGouZ2V0RGlnaXRvcyhudW0pO1xyXG4gICAgICBjb25zdCByZXBsYWNlT2JqZWN0ID0gcmVwbGFjZUJ5TGVuZ3RoW251bS5sZW5ndGhdO1xyXG4gICAgICBudW0gPSBudW0ucmVwbGFjZShyZXBsYWNlT2JqZWN0LnNlYXJjaFZhbHVlLCByZXBsYWNlT2JqZWN0Lm5ld1ZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudW07XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldERpZ2l0b3ModmFsdWUpIHtcclxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcXFxEXCIsIFwiZ1wiKTtcclxuICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCBcIlwiKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgY3BmSXNWYWxpZCh2YWx1ZSk6IGJvb2xlYW4ge1xyXG4gICAgLy8gU8OzIGZheiBhIHZhbGlkYcOnw6NvIHNlIG8gdGV4dG8gbsOjbyBmb3IgdmF6aW8uXHJcbiAgICAvLyBTZSBmb3IgdmF6aW8sIHZhbGlkYXIgY2FtcG8gcmVxdWVyaWRvIG7Do28gw6kgYSByZXNwb25zYWJpbGlkYWRlIGRlc3RhIHZhbGlkYcOnw6NvXHJcbiAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xyXG4gICAgICBsZXQgSXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICBjb25zdCBjcGYgPSBOZ3hDcGZDbnBqLmdldERpZ2l0b3ModmFsdWUpOyAvLyBPYnTDqW0gbyB0ZXh0byBkaWdpdGFkbyBubyBjYW1wbywgcmVtb3ZlIHR1ZG8gbWVub3Mgb3MgZGlnaXRvc1xyXG4gICAgICBpZiAoY3BmLmxlbmd0aCA9PT0gMTEpIHtcclxuICAgICAgICAvLyBTZSBkaWdpdG91IG8gQ1BGIHBvciBjb21wbGV0b1xyXG4gICAgICAgIC8vIFZlcmlmaWNhw6fDo28gZG9zIENQRidzIHF1ZSBuw6NvIHJlc3BlaXRhbSBhIHJlZ3JhIGRlIHZhbGlkYcOnw6NvIG1hcyBuw6NvIHPDo28gdsOhbGlkb3NcclxuICAgICAgICBjb25zdCBjcGZfaW52YWxpZG9zID0gW1xyXG4gICAgICAgICAgXCIwMDAwMDAwMDAwMFwiLFxyXG4gICAgICAgICAgXCIxMTExMTExMTExMVwiLFxyXG4gICAgICAgICAgXCIyMjIyMjIyMjIyMlwiLFxyXG4gICAgICAgICAgXCIzMzMzMzMzMzMzM1wiLFxyXG4gICAgICAgICAgXCI0NDQ0NDQ0NDQ0NFwiLFxyXG4gICAgICAgICAgXCI1NTU1NTU1NTU1NVwiLFxyXG4gICAgICAgICAgXCI2NjY2NjY2NjY2NlwiLFxyXG4gICAgICAgICAgXCI3Nzc3Nzc3Nzc3N1wiLFxyXG4gICAgICAgICAgXCI4ODg4ODg4ODg4OFwiLFxyXG4gICAgICAgICAgXCI5OTk5OTk5OTk5OVwiXHJcbiAgICAgICAgXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcclxuICAgICAgICAgIGlmIChjcGYgPT09IGNwZl9pbnZhbGlkb3NbaV0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIElzVmFsaWQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDYWxjdWxhbmRvIG8gUHJpbWVpcm8gRMOtZ2l0byBWZXJpZmljYWRvclxyXG4gICAgICAgIGxldCBzb21hID0gMDsgLy8gU29tYSBwYXJhIG8gQ1BGIFwiQUJDLkRFRi5HSEktWFpcIjogKEEqMTApKyhCKjkpKy4uLisoSCozKSsoSSoyKVxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7XHJcbiAgICAgICAgICBzb21hID0gc29tYSArIHBhcnNlSW50KGNwZi5jaGFyQXQoaSksIDEwKSAqICgxMCAtIGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgZHYgPSAwOyAvLyBQcmltZWlybyBkw61naXRvIHZlcmlmaWNhZG9yIChzZXLDoSB6ZXJvIHNlIG8gcmVzdG8gZGEgZGl2aXPDo28gZGUgc29tYSBwb3IgMTEgZm9yIDwgMilcclxuICAgICAgICBpZiAoc29tYSAlIDExID4gMSkge1xyXG4gICAgICAgICAgZHYgPSAxMSAtIChzb21hICUgMTEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHBhcnNlSW50KGNwZi5jaGFyQXQoOSksIDEwKSAhPT0gZHYpIHtcclxuICAgICAgICAgIHJldHVybiBJc1ZhbGlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYW5kbyBvIFNlZ3VuZG8gRMOtZ2l0byBWZXJpZmljYWRvclxyXG4gICAgICAgIHNvbWEgPSAwOyAvLyBTb21hIHBhcmEgbyBDUEYgXCJBQkMuREVGLkdISS1YWlwiOiAoQSoxMSkrKEIqMTApKy4uLisoSCo0KSsoSSozKSsoWCoyKVxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgc29tYSA9IHNvbWEgKyBwYXJzZUludChjcGYuY2hhckF0KGkpLCAxMCkgKiAoMTEgLSBpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZHYgPSAwOyAvLyBTZWd1bmRvIGTDrWdpdG8gdmVyaWZpY2Fkb3IgKHNlcsOhIHplcm8gc2UgbyByZXN0byBkYSBkaXZpc8OjbyBkZSBzb21hIHBvciAxMSBmb3IgPCAyKVxyXG4gICAgICAgIGlmIChzb21hICUgMTEgPiAxKSB7XHJcbiAgICAgICAgICBkdiA9IDExIC0gKHNvbWEgJSAxMSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocGFyc2VJbnQoY3BmLmNoYXJBdCgxMCksIDEwKSAhPT0gZHYpIHtcclxuICAgICAgICAgIHJldHVybiBJc1ZhbGlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgSXNWYWxpZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIElzVmFsaWQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzdGF0aWMgY25waklzVmFsaWQodmFsdWUpOiBib29sZWFuIHtcclxuICAgIC8vIFPDsyBmYXogYSB2YWxpZGHDp8OjbyBzZSBvIHRleHRvIG7Do28gZm9yIHZhemlvLlxyXG4gICAgLy8gU2UgZm9yIHZhemlvLCB2YWxpZGFyIGNhbXBvIHJlcXVlcmlkbyBuw6NvIMOpIGEgcmVzcG9uc2FiaWxpZGFkZSBkZXN0YSB2YWxpZGHDp8Ojb1xyXG4gICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgbGV0IElzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgY29uc3QgY25waiA9IE5neENwZkNucGouZ2V0RGlnaXRvcyh2YWx1ZSk7IC8vIE9idMOpbSBvIHRleHRvIGRpZ2l0YWRvIG5vIGNhbXBvLCByZW1vdmUgdHVkbyBtZW5vcyBvcyBkaWdpdG9zXHJcblxyXG4gICAgICBpZiAoY25wai5sZW5ndGggPT09IDE0KSB7XHJcbiAgICAgICAgLy8gU2UgZGlnaXRvdSBvIENOUEogcG9yIGNvbXBsZXRvXHJcbiAgICAgICAgLy8gVmVyaWZpY2HDp8OjbyBkbyBDTlBKIHF1ZSBuw6NvIHJlc3BlaXRhIGEgcmVncmEgZGUgdmFsaWRhw6fDo28gbWFzIG7Do28gc8OjbyB2w6FsaWRvc1xyXG4gICAgICAgIGlmIChjbnBqID09PSBcIjAwMDAwMDAwMDAwMDAwXCIpIHtcclxuICAgICAgICAgIHJldHVybiBJc1ZhbGlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYW5kbyBvIFByaW1laXJvIETDrWdpdG8gVmVyaWZpY2Fkb3JcclxuICAgICAgICBsZXQgc29tYSA9IDA7IC8vIFNvbWEgcGFyYSBvIENOUEogXCJBQi5DREUuRkdIL0lKS0wtWFpcIjogKEEqNSkrKEIqNCkrKEMqMykrKEQqMikrKEUqOSkrKEYqOCkrLi4uKyhLKjMpKyhMKjIpXHJcbiAgICAgICAgbGV0IG11bHQgPSA1OyAvLyBtdWx0aXBsaWNhZG9yXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMjsgaSsrKSB7XHJcbiAgICAgICAgICBzb21hID0gc29tYSArIHBhcnNlSW50KGNucGouY2hhckF0KGkpLCAxMCkgKiBtdWx0O1xyXG4gICAgICAgICAgbXVsdC0tOyAvLyBkZWNyZW1lbnRhIG8gbXVsdGlwbGljYWRvclxyXG4gICAgICAgICAgaWYgKG11bHQgPT09IDEpIHtcclxuICAgICAgICAgICAgbXVsdCA9IDk7XHJcbiAgICAgICAgICB9IC8vIHZvbHRhIG8gbXVsdGlwbGljYWRvciBwYXJhIG8gdmFsb3IgOSAocGFyYSBkZWNyZW1lbnRhciBhdMOpIG8gdmFsb3IgMilcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGR2ID0gMDsgLy8gUHJpbWVpcm8gZMOtZ2l0byB2ZXJpZmljYWRvciAoc2Vyw6EgemVybyBzZSBvIHJlc3RvIGRhIGRpdmlzw6NvIGRlIHNvbWEgcG9yIDExIGZvciA8IDIpXHJcbiAgICAgICAgaWYgKHNvbWEgJSAxMSA+IDEpIHtcclxuICAgICAgICAgIGR2ID0gMTEgLSAoc29tYSAlIDExKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcnNlSW50KGNucGouY2hhckF0KDEyKSwgMTApICE9PSBkdikge1xyXG4gICAgICAgICAgcmV0dXJuIElzVmFsaWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDYWxjdWxhbmRvIG8gU2VndW5kbyBEw61naXRvIFZlcmlmaWNhZG9yXHJcbiAgICAgICAgc29tYSA9IDA7IC8vIFNvbWEgcGFyYSBvIENOUEogXCJBQi5DREUuRkdIL0lKS0wtWFpcIjogKEEqNikrKEIqNSkrKEMqNCkrKEQqMykrKEUqMikrKEYqOSkrLi4uKyhLKjQpKyhMKjMpKyhYKjIpXHJcbiAgICAgICAgbXVsdCA9IDY7IC8vIG11bHRpcGxpY2Fkb3JcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEzOyBpKyspIHtcclxuICAgICAgICAgIHNvbWEgPSBzb21hICsgcGFyc2VJbnQoY25wai5jaGFyQXQoaSksIDEwKSAqIG11bHQ7XHJcbiAgICAgICAgICBtdWx0LS07IC8vIGRlY3JlbWVudGEgbyBtdWx0aXBsaWNhZG9yXHJcbiAgICAgICAgICBpZiAobXVsdCA9PT0gMSkge1xyXG4gICAgICAgICAgICBtdWx0ID0gOTtcclxuICAgICAgICAgIH0gLy8gdm9sdGEgbyBtdWx0aXBsaWNhZG9yIHBhcmEgbyB2YWxvciA5IChwYXJhIGRlY3JlbWVudGFyIGF0w6kgbyB2YWxvciAyKVxyXG4gICAgICAgIH1cclxuICAgICAgICBkdiA9IDA7IC8vIFNlZ3VuZG8gZMOtZ2l0byB2ZXJpZmljYWRvciAoc2Vyw6EgemVybyBzZSBvIHJlc3RvIGRhIGRpdmlzw6NvIGRlIHNvbWEgcG9yIDExIGZvciA8IDIpXHJcbiAgICAgICAgaWYgKHNvbWEgJSAxMSA+IDEpIHtcclxuICAgICAgICAgIGR2ID0gMTEgLSAoc29tYSAlIDExKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcnNlSW50KGNucGouY2hhckF0KDEzKSwgMTApICE9PSBkdikge1xyXG4gICAgICAgICAgcmV0dXJuIElzVmFsaWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBJc1ZhbGlkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gSXNWYWxpZDtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxufVxyXG4iXX0=